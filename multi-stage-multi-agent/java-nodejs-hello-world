pipeline {
    agent none
    stages {
        stage('Back-end: Java Hello World') {
            agent {
                // Use a Docker image that has Java (JDK 11) installed
                docker { image 'maven:3.8.1-adoptopenjdk-11' } 
            }
            steps {
                // 1. Create the Java source file (HelloWorld.java)
                writeFile file: 'HelloWorld.java', text: '''
                    public class HelloWorld {
                        public static void main(String[] args) {
                            System.out.println("Hello from Jenkins via Java!");
                        }
                    }
                '''

                // 2. Compile the Java file using 'javac'
                sh 'javac HelloWorld.java'

                // 3. Execute the compiled class using 'java'
                sh 'java HelloWorld'
            }
        }

        stage('Front-end: Node.js Hello World') {
            agent {
                // Use a Docker image that has Node.js installed
                docker { image 'node:16-alpine' }
            }
            steps {
                // Execute the Node.js code directly using the 'node -e' command
                sh 'node -e "console.log(\'Hello from Jenkins via Node.js!\')"'
                
                // Alternatively, you could save it to a file and run:
                // writeFile file: 'hello.js', text: 'console.log("Hello from Jenkins via Node.js!");'
                // sh 'node hello.js'
            }
        }
    }
}
